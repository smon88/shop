@if(isLoading) {
<app-loading></app-loading>
} @else {
<main class="my-16 max-w-screen-lg mx-auto px-6">
  <section class="flex flex-col md:flex-row gap-4">
    <article class="grid place-content-center rounded-lg bg-gray-100 p-6">
      <div class="relative size-64 sm:size-72 lg:size-96">
        @if (product?.urlImg) {
        <img class="object-contain object-center relative" [ngSrc]="product?.urlImg ?? ''" alt="Product Image" priority
          fill />
        }@else {
        <img priority fill ngSrc="/img/placeholder.jpg" alt="Placeholder Image" />
        }
      </div>
    </article>
    <article class="p-6">
      <h1 class="font-bold text-3xl">{{ product?.name }}</h1>
      <div class="flex gap-2 mt-3">
        <div class="flex items-center gap-1">
          <svg class="size-4 text-yellow-300" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 576 512">
            <path
              d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
          </svg>
          <svg class="size-4 text-yellow-300" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 576 512">
            <path
              d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
          </svg>
          <svg class="size-4 text-yellow-300" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 576 512">
            <path
              d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
          </svg>
          <svg class="size-4 text-yellow-300" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 576 512">
            <path
              d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
          </svg>
          <svg class="size-4 text-yellow-300" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 576 512">
            <path
              d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
          </svg>
        </div>
        <p class="border-l border-gray-500 text-gray-500 ps-2 text-sm">
          {{ product?.reviews }} reviews
        </p>
      </div>
      <div class="mt-5 items-baseline font-bold">
        <h3 class="text-3xl md:text-5xl">{{ product?.price | currency:'COP':'$':'1.0-0' }}</h3>
        @if (product?.previousPrice) {
        <h3 class="text-gray-500 text-xl md:text-2xl line-through">
          {{ product?.previousPrice | currency:'COP':'$':'1.0-0' }}
        </h3>
        }
      </div>
      <div class="mt-5 text-black-900 format-strong:text-black-700 format-li:mb-2 format-p:mb-4"
        [innerHTML]="product?.description"></div>
      <div class="mt-5 flex gap-2">
        <button (click)="addToCart()"
          class="w-full rounded-md focus:ring-4 focus:ring-green-200 bg-gradient-to-tl from-[#06cf86] to-[#0b6142] text-white px-4 py-2 font-bold">
          AÃ±adir al Carrito
        </button>
        <button type="button"
          class="py-2 px-4 inline-flex items-center justify-center text-gray-500 hover:text-gray-900 hover:underline bg-gradient-to-tl from-gray-200 to-gray-50 focus:ring-4 focus:ring-gray-100 rounded-md">
          <svg class="size-6" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
            viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12.01 6.001C6.5 1 1 8 5.782 13.001L12.011 20l6.23-7C23 8 17.5 1 12.01 6.002Z" />
          </svg>
        </button>
      </div>
    </article>
  </section>
  <article class="mt-6 relative">
    <section class="mt-4 max-w-screen-lg mx-auto lg:py-24">
      <h2 class="font-bold text-2xl sm:text-3xl text-center lg:text-4xl">
        Productos Favoritos
      </h2>

      <!-- MOBILE: scroll horizontal -->
      <div class="mt-8 sm:hidden">
        <div class="flex gap-4 overflow-x-auto no-scrollbar px-2">
          @for (product of products; track $index) {
          <div class="min-w-[75%]">
            <app-home-product [product]="product" />
          </div>
          }
        </div>
      </div>

      <!-- DESKTOP / TABLET: carrusel animado -->
      <article class="mt-8 relative hidden sm:block">
        <div class="overflow-hidden">
          <div class="flex transition-transform duration-1000 ease-out will-change-transform"
            [style.transform]="'translate3d(-' + (pageIndex * 100) + '%,0,0)'">
            @for (slide of slides; track $index) {
            <div class="w-full flex-shrink-0 px-1">
              <div class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 items-stretch auto-rows-fr">
                @for (product of slide; track product.productId) {
                <app-home-product [product]="product" />
                }
              </div>
            </div>
            }
          </div>
        </div>

        <!-- Prev -->
        <button (click)="prevProducts()"
          class="absolute top-1/2 -translate-y-1/2 -start-10 z-30 bg-gray-500 hover:bg-gray-400 text-white w-10 h-10 rounded-full">
          <span
            class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-500 group-hover:bg-gray-400 group-focus:ring-4 group-focus:ring-gray-300 group-focus:outline-none">
            <svg class="w-4 h-4 text-white rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
              fill="none" viewBox="0 0 6 10">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M5 1 1 5l4 4" />
            </svg>
            <span class="sr-only">Previous</span>
          </span>
        </button>

        <!-- Next -->
        <button (click)="nextProducts()"
          class="absolute top-1/2 -translate-y-1/2 -end-10 z-30 bg-gray-500 hover:bg-gray-400 text-white w-10 h-10 rounded-full">
          <span
            class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-500 group-hover:bg-gray-400 group-focus:ring-4 group-focus:ring-gray-300 group-focus:outline-none">
            <svg class="w-4 h-4 text-white rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
              fill="none" viewBox="0 0 6 10">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="m1 9 4-4-4-4" />
            </svg>
            <span class="sr-only">Next</span>
          </span>
        </button>

        <!-- Dots -->
        <div class="flex justify-center mt-4 gap-2">
          @for (s of slides; track $index) {
          <button class="w-2.5 h-2.5 rounded-full" [class.bg-gray-900]="$index === pageIndex"
            [class.bg-gray-300]="$index !== pageIndex" (click)="goToPage($index)"></button>
          }
        </div>
      </article>
    </section>
  </article>
</main>
@if (showSuccessToast) {
<div id="toast-danger"
  class="fixed right-5 bottom-5 flex items-center w-full max-w-xs p-4 text-gray-500 bg-white rounded-lg shadow"
  role="alert">
  <div class="inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-green-500 bg-green-100 rounded-lg">
    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
      viewBox="0 0 640 640">
      <path
        d="M320 576C178.6 576 64 461.4 64 320C64 178.6 178.6 64 320 64C461.4 64 576 178.6 576 320C576 461.4 461.4 576 320 576zM438 209.7C427.3 201.9 412.3 204.3 404.5 215L285.1 379.2L233 327.1C223.6 317.7 208.4 317.7 199.1 327.1C189.8 336.5 189.7 351.7 199.1 361L271.1 433C276.1 438 282.9 440.5 289.9 440C296.9 439.5 303.3 435.9 307.4 430.2L443.3 243.2C451.1 232.5 448.7 217.5 438 209.7z" />
    </svg>
    <span class="sr-only">Success icon</span>
  </div>
  <div class="ms-3 text-sm font-normal">
    Producto agregado correctamente
  </div>
  <button (click)="showSuccessToast = false" type="button"
    class="ms-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8"
    data-dismiss-target="#toast-danger" aria-label="Close">
    <span class="sr-only">Close</span>
    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
    </svg>
  </button>
</div>
}
}