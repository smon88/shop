@if(isLoading) {
<app-loading></app-loading>
} @else {
<section class="mt-4 max-w-screen-lg mx-auto px-3 sm:px-0">
  <!-- Barra de filtros -->
  <div
    class="w-full mt-8 bg-white rounded-md shadow-md p-4
           flex flex-col sm:flex-row gap-4 items-center justify-between
           sm:max-w-none mx-auto"
  >
    <!-- Buscar -->
    <div class="w-full sm:w-1/2">
      <input
        type="text"
        placeholder="Buscar producto..."
        class="w-full border border-gray-300 rounded-md px-3 py-2
               focus:outline-none focus:ring-2 focus:ring-gray-400"
        (input)="onSearch($event)"
      />
    </div>

    <!-- Categoría -->
    <div class="w-full sm:w-1/3">
      <select
        class="w-full border border-gray-300 rounded-md px-3 py-2 bg-white
               focus:outline-none focus:ring-2 focus:ring-gray-400"
        (change)="onCategoryChange($event)"
      >
        <option value="">Todas las categorías</option>
        @for (category of categories; track category.id) {
          <option [value]="category.id">{{ category.title }}</option>
        }
      </select>
    </div>
  </div>

  <!-- Grid productos -->
  <article
    class="mt-3 grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4
           gap-4 justify-center mb-8"
  >
    @defer {
      @for (product of filteredProducts; track product.productId) {
        <app-products-list [product]="product" />
      }
    }
    @placeholder (minimum 200ms) {
      <app-home-product-loading />
      <app-home-product-loading />
      <app-home-product-loading />
      <app-home-product-loading />
    }
  </article>
</section>
}